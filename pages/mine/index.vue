<template>
	<view class="login-content">
		<view class="login-block">
			<image
			  v-if="userInfo.avatarUrl"
				class="avatar"
				slot="right"
				:src="userInfo.avatarUrl"
			/>
			<view v-else class="no-img"></view>
			<view class="block-r">
				<text @click="login">{{userInfo.nickName?userInfo.nickName:'去登录'}}</text>
			</view>
		</view>
		
		<scroll-view
			scroll-y
		>
			<!-- <view class="cu-list menu card-menu margin-top-xl margin-bottom-xl shadow-lg radius"> -->
			<template v-if="userType+''==='1'">
				<row-button
					label="累计采购"
					value="--元"
				/>
				<row-button
					label="咨询客服"
					arrow
				/>
				<row-button
					label="资质认证"
					value="去认证>"
					@click.native="qualifications"
				/>
				<row-button
					label="清除缓存"
					arrow
					@click.native="clear"
				/>
				<row-button
					label="当前版本"
					value="1.0.0"
				/>
			</template>
			<template v-else>
				<row-button
					label="订单笔数"
					value="--笔"
				/>
				<row-button
					label="订单金额"
					value="--元"
				/>
				<row-button
					label="查看订单"
					arrow
					@click.native="gotoOrder"
				/>
				<row-button
					label="我的邀请码"
					arrow
					@click.native="gotoInvite"
				/>
				<row-button
					label="当前版本"
					value="1.0.0"
				/>
			</template>
			
			<!-- </view> -->
			<!-- <view class="cu-tabbar-height"></view> -->
		</scroll-view>
	</view>
</template>

<script>
import RowButton from '@/components/row-button';
import avatarUrl from '@/static/1.png';
import {getPharmacy} from "@/api/auth.js"
export default {
  components: {
    RowButton,
  },
  data() {
    return {
			userInfo:this.$store.getUserInfo()?.userInfo,
    };
  },
	async onReady() {
		console.log()
		this.userInfo=this.$store.getUserInfo()?.userInfo;
	},
  methods: {
		getPharmacy(){
			const that=this;
			const id=that.$store.getLoginInfo()?.data?.userId;
			const obj=this.$store.getUserInfo()?.userInfo||{};
			if(!id) {
				that.$loading.close()
				return;
			};
			getPharmacy(id).then(({data})=>{
				that.data={
					...data.data||{},
					...obj,
				}
				that.$loading.close()
			}).finally((e)=>{
				that.$loading.close()
			})
		},
		qualifications(){
			console.log('authentication')
			uni.navigateTo({
			  url: '/pages/qualifications/index',
			});
		},	
		login(){
			if(this.userInfo?.nickName) return;
			uni.navigateTo({
			  url: '/pages/login/index',
			});
		},
		clear(){
			this.$store.setLoginInfo(null);
			this.$store.setUserInfo(null);
			this.$store.setAddrsInfo(null);
			this.$store.setRequestSubscribeMessage(null);
			this.$store.setOrder(null);
			this.userInfo={};
			uni.$emit('shoppingCartCount',0);
			this.$tips('成功','缓存清理成功');
		},
		gotoOrder(){
			uni.navigateTo({
			  url: '/pages/salesman/order/index',
			});
		},
    gotoInvite() {
      uni.navigateTo({
        url: '/pages/invite/index',
      });
    },
  },
  computed: {
		userType(){
		  return this.$store.getLoginInfo()?.data?.userType||'1'
		}
  },
};
</script>

<style lang="scss" scoped>
.content {
  .text {
    color: var(--font-color-0);
  }
}
.login-content{
	position: absolute;
	top: 60px;
	left: 0;
	height: 100%;
	width: 100%;
	z-index: 9;
}
.login-block{
	background-color: var(--background-color-0);
	margin-bottom: 10px;
	display: flex;
	padding: 20rpx;
	align-items: flex-start;
	.block-r{
		font-size: 40rpx;
		font-weight: 600;
		margin-top: 20rpx;
	}
}
.no-img{
	background-color: #e0e0e0;
}
.avatar,.no-img {
	width: 100px;
	height: 100px;
	margin-right: 40rpx;
}
</style>
